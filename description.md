# полезные ссылки
аук - https://topdeck.ru/apps/toptrade/auctions
магазин с2с - https://topdeck.ru/apps/toptrade/singles/search?q=Phyrexian+Altar
база карт - https://scryfall.com
у scryfall есть апи - обратите внимание на oracle_id + illustration_id - https://api.scryfall.com/cards/6dff6978-a794-4f4c-9039-594b15e7dbfe?format=json&pretty=true

# проблема

## предыстория

у меня есть список карт которые я хочу купить - например https://moxfield.com/decks/f0SowVSXpke3iMZunOGF4Q
обычно это делается с2с - напрямую у другого человека (не через магазин)
самый дешевый способ для покупателя - через аукцион - например https://topdeck.ru/apps/toptrade/auctions

## суть проблемы

сейчас чтобы нет массового поиска
то есть чтобы найти нужные карты мне нужно периодически (в идеале каждый день) проходиться по поиску ауков для каждой карты
и затем уже ставить если такие нашлись (обычно 1 аук в неделю в лучшем случае)

## в чем боль
много занимает времени
легко пропустить важный аук
не могу быстро достать цену из магазина (может быть там уже дешевле чем поднялись ставки)

# как в идеале должно работать

я оставляю свой вишлист куда то
приложуха постоянно чекает цены на ауках
как только создается аук для карты из листа - приходит уведомляшка со ссылкой на аук
если я оставил ставку, то вижу ее в хелпере

## доп плюхи

иметь возможность зарегаться и видеть свои ставки + сравнение с минимальной ценой из магазинов
другие источники ауков

---

# что я хочу подробнее

## управлять вишлистом (вишлистами)
- могу добавлять ссылку на лист
- руками делать свой лист без импорта
- указывать издание, фойл или нет, состояние, кол-во и тд (или не указывать, типа любое)

## аукционы
- пока пусть будет только topdeck
- надо чтобы определялось ТОЧНО название, остальное можно ошибаться

## уведомления
- выбирать настройки уведомлений - при каких событиях и как часто
- указать где я хочу их получать - онли веб, тг, ...
- получить уведомление при появлении нового релевантного аука
- мб какую то сводку хз

## цены
- по каждой карте из вишлиста по которой есть релевантный аук подтягивать цены из магазина (https://topdeck.ru/apps/toptrade/singles/search)
- указывать мин цену рядом с ауком

---

# как на мой взгляд должно работать

## компоненты

### 1 - веб приложение
- есть аутентификация
- можно оставлять ссылки на свои вишлисты (потенциально больше чем 1)
- результаты массового поиска по аукционам
- куда слать уведомления при появлении нового аука из вишлиста

### 2 - бд
- у любой карты (включая издание и язык) есть id, не знаю надо или нет
- postgres (или подобное) с данными пользователя, вишлистами и тд
- s3 для фоток ауков
- хз надо ли что то отдельное для поиска

### 3 - сервисы
- краулер(ы)
- scheduler всякого дерьма
- сканер - по фотке или описанию надо понимать что за карта (не тривиально)
- alerting service
- notification service

## flow

- скедюлер запускает краулеры
- краулеры наполняют базку с ауками
- сканер забирает сырые данные, отдает id карты
- alerting чекает есть ли новые таски и создает там все что надо
- notification нотифицирует

---

тут нужно дохуя парсеров/краулеров сделать (аук + цены из магазов)
хранить в какой то базке резы краулеров
вебморда + базка для вишлистов + крон с уведомлениями

нахуя это делать - цены могут отличаться раза в два, для некоторых карт типа 50$ на ауке, 100$ в магазе

уже есть половинчатое решение = приложуха на телефон magichelper - там есть уведомляшки + поиск адекватный по аукам, но нет автопоиска и нет массового поиска (ну и то что это приложуха на мобилу а не веб)

одна и та же карта может быть в разных изданиях и тд, от этого зависит стоимость, не всегда это указывают в описании
